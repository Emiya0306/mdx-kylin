FROM python:2.7.13-slim

ARG DEPS='build-essential libssl-dev libffi-dev python-dev libsasl2-dev libldap2-dev'

RUN apt-get update && apt-get -y install ${DEPS}
RUN pip install --upgrade setuptools pip
RUN pip install --no-cache-dir superset kylinpy

RUN fabmanager create-admin --app superset --username admin --password admin --firstname admin --lastname admin --email admin@fab.org
RUN superset db upgrade
RUN superset load_examples
RUN superset init

EXPOSE 8099
CMD ["superset", "runserver", "-p", "8099", "-a", "0.0.0.0"]
